import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.IOException;
import javax.swing.*;
import java.util.Random;
//Importing the necessary Packages

public class ButtonMethods extends JFrame {
	
	static Showhuman showh = new Showhuman();
	static Travelhuman travelh = new Travelhuman();
	static JButton[][] buttons = new JButton[8][8];
    static Icon human = new ImageIcon("C:/Users/maxan/Desktop/Eclipse Workspace/Human.jpg");
    static Icon dontmove = new ImageIcon("C:/Users/maxan/Desktop/Eclipse Workspace/dontmove.png");
	static Icon alien = new ImageIcon("C:/Users/maxan/Desktop/Eclipse Workspace/Alien.jpg");
    //Initializing the Objects that will be needed throughout the whole code (ActionsListener, Buttons and Images)
	
	public static void main(String[] args) throws IOException {
		new ButtonMethods();
		new StartGame();
	}

	public ButtonMethods () throws IOException {
		setup();
		Initializehumans(3);
		Initializealiens(3);
	}
	
	public static class Showhuman implements ActionListener {
		int x,y;
		public void actionPerformed(ActionEvent e)
		{
			for(int i=0;i<8;i++) {
				for(int j=0;j<8;j++) {
					if(e.getSource() == buttons[i][j])
					{
						x = i;
						y = j;
						break;
					//Going trough all Buttons and figuring out which buttons was pressed
					}
				}
			}
			for(int a = x-2;a<=x+2;a++) {
				if(a>7 || a<0) {}
					else
					{
						for(int b = y-2;b<=y+2;b++) {
						if(b>7 || b<0) {}
						else {
							if(buttons[a][b].getIcon() == human){
								buttons[a][b].setIcon(dontmove);
								buttons[a][b].removeActionListener(showh);
							}
							else
							{
								buttons[a][b].setVisible(true);
								buttons[a][b].setText("Here?");
								buttons[a][b].removeActionListener(showh);
								buttons[a][b].addActionListener(travelh);
								//Making Buttons in a radius of 2 visible to move the human
							}
						}
						}
					}
			}
			buttons[x][y].setVisible(false);
			buttons[x][y].setIcon(null);
			//The button that was pressed gets invisible(So the player can't move the player to the position it is already on	
		}	
	}	
	private static class Travelhuman implements ActionListener
	{
		public void actionPerformed(ActionEvent e)
		{
			long timeStart = System.currentTimeMillis();
			for(int i =0;i<8;i++) {
				for(int j=0;j<8;j++) {
					buttons[i][j].addActionListener(showh);
					if(e.getSource() == buttons[i][j]) {
						buttons[i][j].setVisible(true);
						buttons[i][j].removeActionListener(showh);
						buttons[i][j].setIcon(human);
						//Removing the Action Listener from all the buttons in the radius of 2 and adding a new one to replace the selected buttonicon with the human -> Completed movement
					}
					else {
						if(buttons[i][j].getIcon() == human || buttons[i][j].getIcon() == dontmove)
						{
							buttons[i][j].setVisible(true);
							buttons[i][j].setIcon(human);
						}
						else if(buttons[i][j].getIcon() == alien) {
							buttons[i][j].setVisible(true);
							buttons[i][j].setIcon(alien);
						}
						else
						{
						buttons[i][j].setVisible(false);
						//Setting the rest of the buttons invisible
						}
					}
				}
			}
			long timeEnd = System.currentTimeMillis();
			System.out.println("The call of the Action-Listener(travel) took "+ (timeEnd-timeStart) +"seconds");
		
		}
		
	}
	public static JButton retbutton(int x, int y) {
		return buttons[x][y];
	}
	void setup() {
		for(int i=0;i<8;i++) {
			for(int j=0;j<8;j++) {
				buttons[i][j] = Initialize.retbutton(i,j);
				buttons[i][j].addActionListener(showh);
				buttons[i][j].setVisible(false);
			}
		}
	}
	void Initializehumans(int count)
	{
		int humancount=0;
		Random rand = new Random();
		do {
			int x = rand.nextInt(2) + 6;
			int y = rand.nextInt(8);
			if(buttons[x][y].getIcon() == human) {}
			else
			{
			buttons[x][y].setVisible(true);
			buttons[x][y].setIcon(human);
			buttons[x][y].removeActionListener(showh);
			humancount++;
			}
		}while(humancount < count);
		//Initializing 3 randomly chosen Buttons
	}
	void Initializealiens(int count) {
		int aliencount=0;
		Random rand = new Random();
		do {
			int x = rand.nextInt(2);
			int y = rand.nextInt(8);
			if(buttons[x][y].getIcon() == alien) {}
			else
			{
			buttons[x][y].setVisible(true);
			buttons[x][y].setIcon(alien);
			buttons[x][y].removeActionListener(showh);
			aliencount++;
			}
		}while(aliencount < count);
	}
}